{% extends 'base.html' %}

{% block main %}
<h2>{{ thread.title }}</h2>
<p><strong>Category:</strong> {{ thread.category }}</p>
<p>{{ thread.entry }}</p>
{% if thread.image %}
  <img src="{{ thread.image.url }}" alt="Thread Image">
{% endif %}

{% if thread.author == request.user.profile %}
  <p><a href="{% url 'forum:thread-edit' thread.pk %}">Edit Thread</a></p>
{% endif %}

<h3>Related Threads</h3>
<ul>
  {% for t in related_threads %}
    <li><a href="{% url 'forum:thread-detail' t.pk %}">{{ t.title }}</a></li>
  {% endfor %}
</ul>

<a href="{% url 'forum:thread-list' %}">Back to Threads</a>

<h3>Comments</h3>
<ul>
  {% for comment in comments %}
    <li><strong>{{ comment.author }}</strong>: {{ comment.entry }}</li>
  {% empty %}
    <li>No comments yet.</li>
  {% endfor %}
</ul>

{% if user.is_authenticated %}
  <h4>Leave a comment:</h4>
  <form method="post">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit">Post Comment</button>
  </form>
{% else %}
  <p>You must be logged in to comment.</p>
{% endif %}
{% endblock %}
